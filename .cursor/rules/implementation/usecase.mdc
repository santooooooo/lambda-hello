---
description: ユースケース層の実装ルール
globs: ["aws-batch/usecase/**/*.py"]
alwaysApply: false
---

# ユースケース層のルール

## サービスクラス
- サービスクラスは `*_service.py` という命名規則に従う
- リポジトリはインターフェース型で保持すること
- `__init__` でリポジトリの実装を注入する

## メソッド設計
- メソッド名は動詞で始める（`get`, `insert`, `create` など）
- 戻り値の型を明示すること
- `None` を返す可能性がある場合は `| None` を使用

## 日付処理
- 文字列の日付を `datetime` オブジェクトに変換する場合は `datetime.strptime()` を使用
- 日付の形式に注意すること（`'%Y-%m-%d'` または `'%Y%m%d'`）

## エラーハンドリング
- リポジトリから返される `Either` 型を適切に処理すること
- `fold` メソッドを使用してエラー処理を行う

## ビジネスロジック
- **ビジネスルールはドメイン層に実装すること**（`architecture.mdc`を参照）
- ユースケース層は複数のドメインオブジェクトやリポジトリを組み合わせてユースケースを実現する
- ユースケース固有のオーケストレーションロジック（例: 複数のリポジトリ呼び出しの順序、条件分岐による処理の分岐など）はユースケース層に実装
- 純粋なビジネスルール（例: 価格計算、検証ルール、ビジネスルールに基づく計算）はドメイン層に実装
